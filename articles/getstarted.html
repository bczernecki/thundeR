<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the thundeR package • thundeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the thundeR package">
<meta property="og:description" content="thunder">
<meta property="og:image" content="https://bczernecki.github.io/thunder/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">thundeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/convective-parameters-and-technical-details.html">List of convective parameters and other important details</a>
    </li>
    <li>
      <a href="../articles/getstarted.html">Introduction to the thundeR package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bczernecki/thunder/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the thundeR package</h1>
                        <h4 data-toc-skip class="author">Bartosz
Czernecki, Mateusz Taszarek, Piotr Szuster</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bczernecki/thunder/blob/HEAD/vignettes/getstarted.Rmd" class="external-link"><code>vignettes/getstarted.Rmd</code></a></small>
      <div class="hidden name"><code>getstarted.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="thunder">thundeR
<img src="reference/figures/logo.png" align="right" width="150"><a class="anchor" aria-label="anchor" href="#thunder"></a>
</h2>
<p><strong><code>thundeR</code></strong> is a freeware R package and
collection of functions for rapid computation and visualisation of
convective parameters commonly used in the operational forecasting of
severe convective storms. Core algorithm is based on C++ code
implemented into R language via <code>Rcpp</code>. This solution allows
to compute over 200 thermodynamic and kinematic parameters in less than
0.02s per profile and process large datasets such as reanalyses or
operational NWP models in a reasonable amount of time. Package has been
developed since 2017 by research meteorologists specializing in severe
convective storms and is constantly updated with new features.</p>
<div class="section level3">
<h3 id="online-browser">Online browser:<a class="anchor" aria-label="anchor" href="#online-browser"></a>
</h3>
<p>Online rawinsonde browser of <code>thundeR</code> package is
available at <a href="http://rawinsonde.com" class="external-link uri">http://rawinsonde.com</a></p>
</div>
<div class="section level3">
<h3 id="main-functions">Main functions:<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h3>
<ul>
<li><p><strong><code><a href="../reference/sounding_compute.html">sounding_compute()</a></code></strong> - A core
function for calculating convective parameters commonly used in the
operational prediction of severe convective storms. Returns a vector of
parameters.</p></li>
<li><p><strong><code><a href="../reference/sounding_plot.html">sounding_plot()</a></code></strong> - Function to plot
a composite of Skew-T, hodograph and selected convective parameters on a
single layout</p></li>
<li><p><strong><code><a href="../reference/sounding_save.html">sounding_save()</a></code></strong><code>- Auxiliary function to</code>sounding_plot`
that plots a composite of Skew-T, hodograph and selected convective
parameters on a single layout and exports graphical file.</p></li>
<li><p><strong><code><a href="../reference/get_sounding.html">get_sounding()</a></code></strong> - Download
rawinsonde measurement from sounding database of the University of
Wyoming in a form convenient to use with <code>thundeR</code>
package.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>Examples show aplication of selected <code>thundeR</code> package
functions</p>
<div class="section level4">
<h4 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>Draw Skew-T, hodograph and convective parameters on a single layout
and export to png file:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bczernecki.github.io/thundeR/" class="external-link">thunder</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sounding_vienna"</span><span class="op">)</span> <span class="co"># load example dataset (Vienna rawinsonde profile for 23 Aug 2011 12UTC):</span></span>
<span><span class="va">pressure</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">pressure</span> <span class="co"># vector of pressure [hPa]</span></span>
<span><span class="va">altitude</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">altitude</span> <span class="co"># vector of altitude [meters]</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">temp</span>  <span class="co"># vector of temperature [degree Celsius]</span></span>
<span><span class="va">dpt</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">dpt</span> <span class="co"># vector of dew point temperature [degree Celsius]</span></span>
<span><span class="va">wd</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">wd</span> <span class="co"># vector of wind direction [azimuth in degrees]</span></span>
<span><span class="va">ws</span> <span class="op">=</span> <span class="va">sounding_vienna</span><span class="op">$</span><span class="va">ws</span> <span class="co"># vector of wind speed [knots]</span></span>
<span><span class="fu"><a href="../reference/sounding_save.html">sounding_save</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Vienna.png"</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"Vienna - 23 August 2011 1200 UTC"</span>,</span>
<span>              <span class="va">pressure</span>, <span class="va">altitude</span>, <span class="va">temp</span>, <span class="va">dpt</span>, <span class="va">wd</span>, <span class="va">ws</span><span class="op">)</span></span>
<span><span class="co">#&gt; Your display device is 10 x 6 in. </span></span>
<span><span class="co">#&gt; It is recommended to use at least 10 x 7.5 in. plotting window </span></span>
<span><span class="co">#&gt; or consider saving the layout into file</span></span></code></pre></div>
<p><img src="https://github.com/bczernecki/thundeR/raw/master/inst/figures/Vienna.png" alt="Vienna" width="1000"></p>
</div>
<div class="section level4">
<h4 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>Download North Platte rawinsonde profile for 03 Jul 1999 00UTC and
export to png file:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">profile</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_sounding.html">get_sounding</a></span><span class="op">(</span>wmo_id <span class="op">=</span> <span class="fl">72562</span>, yy <span class="op">=</span> <span class="fl">1999</span>, mm <span class="op">=</span> <span class="fl">7</span>, dd <span class="op">=</span> <span class="fl">3</span>, hh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "http://weather.uwyo.edu/cgi-bin/sounding?TYPE=TEXT%3ALIST&amp;YEAR=1999&amp;MONTH=07&amp;FROM=0300&amp;TO=0300&amp;STNM=72562"</span></span>
<span><span class="co">#&gt; /tmp/RtmpRFM7tN/file1b2e28eb404d</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">profile</span><span class="op">)</span> <span class="co"># show first few rows of downloaded dataset</span></span>
<span><span class="co">#&gt;   pressure altitude temp dpt  wd ws</span></span>
<span><span class="co">#&gt; 3      906      849   32  26 110 14</span></span>
<span><span class="co">#&gt; 4      899      914   31  25 120 14</span></span>
<span><span class="co">#&gt; 5      869     1219   28  22 145 13</span></span>
<span><span class="co">#&gt; 6      850     1414   26  21 155 15</span></span>
<span><span class="co">#&gt; 7      811     1829   22  19 175 17</span></span>
<span><span class="co">#&gt; 8      802     1924   21  19 183 17</span></span>
<span><span class="fu"><a href="../reference/sounding_save.html">sounding_save</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"NorthPlatte.png"</span>, title <span class="op">=</span> <span class="st">"North Platte - 03 July 1999 0000 UTC"</span>, <span class="va">profile</span><span class="op">$</span><span class="va">pressure</span>, <span class="va">profile</span><span class="op">$</span><span class="va">altitude</span>, <span class="va">profile</span><span class="op">$</span><span class="va">temp</span>, <span class="va">profile</span><span class="op">$</span><span class="va">dpt</span>, <span class="va">profile</span><span class="op">$</span><span class="va">wd</span>, <span class="va">profile</span><span class="op">$</span><span class="va">ws</span><span class="op">)</span></span>
<span><span class="co">#&gt; Your display device is 10 x 6 in. </span></span>
<span><span class="co">#&gt; It is recommended to use at least 10 x 7.5 in. plotting window </span></span>
<span><span class="co">#&gt; or consider saving the layout into file</span></span></code></pre></div>
<p><img src="https://github.com/bczernecki/thundeR/raw/master/inst/figures/NorthPlatte.png" alt="North Platte" width="1000"></p>
</div>
<div class="section level4">
<h4 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<p>Compute convective parameters based on a sample vertical profile
data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pressure</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">855</span>, <span class="fl">700</span>, <span class="fl">500</span>, <span class="fl">300</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># pressure [hPa]</span></span>
<span><span class="va">altitude</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1500</span>, <span class="fl">2500</span>, <span class="fl">6000</span>, <span class="fl">8500</span>, <span class="fl">12000</span>, <span class="fl">25000</span><span class="op">)</span> <span class="co"># altitude [meters]</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">92</span><span class="op">)</span> <span class="co"># temperature [degree Celsius]</span></span>
<span><span class="va">dpt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">55</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">99</span><span class="op">)</span> <span class="co"># dew point temperature [degree Celsius]</span></span>
<span><span class="va">wd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">135</span>, <span class="fl">180</span>, <span class="fl">270</span>, <span class="fl">350</span>, <span class="fl">0</span><span class="op">)</span> <span class="co"># wind direction [azimuth in degress]</span></span>
<span><span class="va">ws</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="co"># wind speed [knots]</span></span>
<span><span class="va">accuracy</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># accuracy of computations where 3 = high (slow), 2 = medium (recommended), 1 = low (fast)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># change output formatting precision </span></span>
<span><span class="fu"><a href="../reference/sounding_compute.html">sounding_compute</a></span><span class="op">(</span><span class="va">pressure</span>, <span class="va">altitude</span>, <span class="va">temp</span>, <span class="va">dpt</span>, <span class="va">wd</span>, <span class="va">ws</span>, <span class="va">accuracy</span><span class="op">)</span></span>
<span><span class="co">#&gt;              MU_CAPE          MU_CAPE_M10       MU_CAPE_M10_PT </span></span>
<span><span class="co">#&gt;             2.27e+03             9.98e+02             3.13e+02 </span></span>
<span><span class="co">#&gt;         MU_02km_CAPE         MU_03km_CAPE          MU_HGL_CAPE </span></span>
<span><span class="co">#&gt;             2.48e+02             5.76e+02             1.62e+03 </span></span>
<span><span class="co">#&gt;               MU_CIN           MU_LCL_HGT           MU_LFC_HGT </span></span>
<span><span class="co">#&gt;             0.00e+00             7.30e+02             7.30e+02 </span></span>
<span><span class="co">#&gt;            MU_EL_HGT                MU_LI            MU_LI_M10 </span></span>
<span><span class="co">#&gt;             8.30e+03            -1.01e+01            -1.09e+01 </span></span>
<span><span class="co">#&gt;              MU_WMAX           MU_EL_TEMP          MU_LCL_TEMP </span></span>
<span><span class="co">#&gt;             6.74e+01            -2.88e+01             1.77e+01 </span></span>
<span><span class="co">#&gt;          MU_LFC_TEMP              MU_MIXR          MU_CAPE_500 </span></span>
<span><span class="co">#&gt;             1.77e+01             1.49e+01             1.08e+03 </span></span>
<span><span class="co">#&gt;      MU_CAPE_500_M10   MU_CAPE_500_M10_PT           MU_CIN_500 </span></span>
<span><span class="co">#&gt;             3.89e+02             1.37e+02             0.00e+00 </span></span>
<span><span class="co">#&gt;            MU_LI_500        MU_LI_500_M10              SB_CAPE </span></span>
<span><span class="co">#&gt;            -5.04e+00            -6.23e+00             2.27e+03 </span></span>
<span><span class="co">#&gt;          SB_CAPE_M10       SB_CAPE_M10_PT         SB_02km_CAPE </span></span>
<span><span class="co">#&gt;             9.98e+02             3.13e+02             2.48e+02 </span></span>
<span><span class="co">#&gt;         SB_03km_CAPE          SB_HGL_CAPE               SB_CIN </span></span>
<span><span class="co">#&gt;             5.76e+02             1.62e+03             0.00e+00 </span></span>
<span><span class="co">#&gt;           SB_LCL_HGT           SB_LFC_HGT            SB_EL_HGT </span></span>
<span><span class="co">#&gt;             7.30e+02             7.30e+02             8.30e+03 </span></span>
<span><span class="co">#&gt;                SB_LI            SB_LI_M10              SB_WMAX </span></span>
<span><span class="co">#&gt;            -1.01e+01            -1.09e+01             6.74e+01 </span></span>
<span><span class="co">#&gt;           SB_EL_TEMP          SB_LCL_TEMP          SB_LFC_TEMP </span></span>
<span><span class="co">#&gt;            -2.88e+01             1.77e+01             1.77e+01 </span></span>
<span><span class="co">#&gt;              SB_MIXR              ML_CAPE          ML_CAPE_M10 </span></span>
<span><span class="co">#&gt;             1.49e+01             1.65e+03             6.70e+02 </span></span>
<span><span class="co">#&gt;       ML_CAPE_M10_PT         ML_02km_CAPE         ML_03km_CAPE </span></span>
<span><span class="co">#&gt;             2.25e+02             1.64e+02             4.22e+02 </span></span>
<span><span class="co">#&gt;          ML_HGL_CAPE               ML_CIN           ML_LCL_HGT </span></span>
<span><span class="co">#&gt;             1.25e+03             0.00e+00             9.75e+02 </span></span>
<span><span class="co">#&gt;           ML_LFC_HGT            ML_EL_HGT                ML_LI </span></span>
<span><span class="co">#&gt;             9.75e+02             7.90e+03            -7.62e+00 </span></span>
<span><span class="co">#&gt;            ML_LI_M10              ML_WMAX           ML_EL_TEMP </span></span>
<span><span class="co">#&gt;            -8.58e+00             5.74e+01            -2.64e+01 </span></span>
<span><span class="co">#&gt;          ML_LCL_TEMP          ML_LFC_TEMP              ML_MIXR </span></span>
<span><span class="co">#&gt;             1.52e+01             1.52e+01             1.30e+01 </span></span>
<span><span class="co">#&gt;             LR_0500m              LR_01km              LR_02km </span></span>
<span><span class="co">#&gt;            -1.00e+01            -1.00e+01            -1.00e+01 </span></span>
<span><span class="co">#&gt;              LR_03km              LR_04km              LR_06km </span></span>
<span><span class="co">#&gt;            -9.05e+00            -7.86e+00            -6.67e+00 </span></span>
<span><span class="co">#&gt;              LR_16km              LR_26km              LR_24km </span></span>
<span><span class="co">#&gt;            -6.00e+00            -5.00e+00            -5.77e+00 </span></span>
<span><span class="co">#&gt;              LR_36km          LR_26km_MAX         LR_500700hPa </span></span>
<span><span class="co">#&gt;            -4.29e+00            -5.71e+00            -4.29e+00 </span></span>
<span><span class="co">#&gt;         LR_500800hPa         LR_600800hPa             FRZG_HGT </span></span>
<span><span class="co">#&gt;            -5.18e+00            -5.83e+00             2.50e+03 </span></span>
<span><span class="co">#&gt;     FRZG_wetbulb_HGT  HGT_max_thetae_03km  HGT_min_thetae_04km </span></span>
<span><span class="co">#&gt;             2.28e+03             0.00e+00             3.75e+03 </span></span>
<span><span class="co">#&gt;         Delta_thetae Delta_thetae_min04km          Thetae_01km </span></span>
<span><span class="co">#&gt;             2.81e+01             2.88e+01             3.31e+02 </span></span>
<span><span class="co">#&gt;          Thetae_02km                DCAPE   Cold_Pool_Strength </span></span>
<span><span class="co">#&gt;             3.24e+02             5.98e+02             1.26e+01 </span></span>
<span><span class="co">#&gt;           Wind_Index           PRCP_WATER   Moisture_Flux_02km </span></span>
<span><span class="co">#&gt;             3.39e+01             2.71e+01             3.04e+01 </span></span>
<span><span class="co">#&gt;              RH_01km              RH_02km              RH_14km </span></span>
<span><span class="co">#&gt;             7.29e-01             7.20e-01             6.45e-01 </span></span>
<span><span class="co">#&gt;              RH_25km              RH_36km               RH_HGL </span></span>
<span><span class="co">#&gt;             5.55e-01             4.44e-01             4.60e-01 </span></span>
<span><span class="co">#&gt;             BS_0500m              BS_01km              BS_02km </span></span>
<span><span class="co">#&gt;             1.92e+00             3.83e+00             8.78e+00 </span></span>
<span><span class="co">#&gt;              BS_03km              BS_06km              BS_08km </span></span>
<span><span class="co">#&gt;             1.27e+01             1.80e+01             1.74e+01 </span></span>
<span><span class="co">#&gt;              BS_36km              BS_26km              BS_16km </span></span>
<span><span class="co">#&gt;             9.37e+00             1.33e+01             1.66e+01 </span></span>
<span><span class="co">#&gt;              BS_18km            BS_EFF_MU            BS_EFF_SB </span></span>
<span><span class="co">#&gt;             2.03e+01             1.42e+01             1.42e+01 </span></span>
<span><span class="co">#&gt;            BS_EFF_ML        BS_SFC_to_M10        BS_1km_to_M10 </span></span>
<span><span class="co">#&gt;             1.39e+01             1.55e+01             1.36e+01 </span></span>
<span><span class="co">#&gt;        BS_2km_to_M10     BS_MU_LFC_to_M10     BS_SB_LFC_to_M10 </span></span>
<span><span class="co">#&gt;             9.88e+00             1.41e+01             1.41e+01 </span></span>
<span><span class="co">#&gt;     BS_ML_LFC_to_M10        BS_MW02_to_SM        BS_MW02_to_RM </span></span>
<span><span class="co">#&gt;             1.37e+01             7.30e+00             1.01e+01 </span></span>
<span><span class="co">#&gt;        BS_MW02_to_LM         BS_HGL_to_SM         BS_HGL_to_RM </span></span>
<span><span class="co">#&gt;             1.08e+01             4.89e+00             7.79e+00 </span></span>
<span><span class="co">#&gt;         BS_HGL_to_LM             MW_0500m              MW_01km </span></span>
<span><span class="co">#&gt;             9.99e+00             2.31e+00             2.43e+00 </span></span>
<span><span class="co">#&gt;              MW_02km              MW_03km              MW_06km </span></span>
<span><span class="co">#&gt;             3.35e+00             4.80e+00             7.81e+00 </span></span>
<span><span class="co">#&gt;              MW_13km          SRH_100m_RM          SRH_250m_RM </span></span>
<span><span class="co">#&gt;             6.84e+00             4.25e+00             1.01e+01 </span></span>
<span><span class="co">#&gt;          SRH_500m_RM           SRH_1km_RM           SRH_3km_RM </span></span>
<span><span class="co">#&gt;             1.97e+01             3.96e+01             1.53e+02 </span></span>
<span><span class="co">#&gt;          SRH_36km_RM          SRH_100m_LM          SRH_250m_LM </span></span>
<span><span class="co">#&gt;             2.37e+02             1.50e+00             3.55e+00 </span></span>
<span><span class="co">#&gt;          SRH_500m_LM           SRH_1km_LM           SRH_3km_LM </span></span>
<span><span class="co">#&gt;             6.97e+00             1.40e+01            -1.31e+01 </span></span>
<span><span class="co">#&gt;          SRH_36km_LM           SV_500m_RM           SV_01km_RM </span></span>
<span><span class="co">#&gt;            -2.44e+01             3.90e-03             3.88e-03 </span></span>
<span><span class="co">#&gt;           SV_03km_RM           SV_500m_LM           SV_01km_LM </span></span>
<span><span class="co">#&gt;             4.80e-03             1.01e-03             1.10e-03 </span></span>
<span><span class="co">#&gt;           SV_03km_LM        MW_SR_500m_RM        MW_SR_01km_RM </span></span>
<span><span class="co">#&gt;            -1.44e-03             1.01e+01             1.02e+01 </span></span>
<span><span class="co">#&gt;        MW_SR_03km_RM        MW_SR_500m_LM        MW_SR_01km_LM </span></span>
<span><span class="co">#&gt;             9.54e+00             1.38e+01             1.29e+01 </span></span>
<span><span class="co">#&gt;        MW_SR_03km_LM     MW_SR_VM_500m_RM     MW_SR_VM_01km_RM </span></span>
<span><span class="co">#&gt;             8.46e+00             1.01e+01             1.02e+01 </span></span>
<span><span class="co">#&gt;     MW_SR_VM_03km_RM     MW_SR_VM_500m_LM     MW_SR_VM_01km_LM </span></span>
<span><span class="co">#&gt;             1.05e+01             1.38e+01             1.28e+01 </span></span>
<span><span class="co">#&gt;     MW_SR_VM_03km_LM       SV_FRA_500m_RM       SV_FRA_01km_RM </span></span>
<span><span class="co">#&gt;             8.83e+00             9.98e-01             9.87e-01 </span></span>
<span><span class="co">#&gt;       SV_FRA_03km_RM       SV_FRA_500m_LM       SV_FRA_01km_LM </span></span>
<span><span class="co">#&gt;             9.56e-01             2.59e-01             2.80e-01 </span></span>
<span><span class="co">#&gt;       SV_FRA_03km_LM         Bunkers_RM_A         Bunkers_RM_M </span></span>
<span><span class="co">#&gt;            -2.86e-01             2.09e+02             7.79e+00 </span></span>
<span><span class="co">#&gt;         Bunkers_LM_A         Bunkers_LM_M         Bunkers_MW_A </span></span>
<span><span class="co">#&gt;             1.22e+02             1.32e+01             1.52e+02 </span></span>
<span><span class="co">#&gt;         Bunkers_MW_M   Corfidi_downwind_A   Corfidi_downwind_M </span></span>
<span><span class="co">#&gt;             7.81e+00             2.19e+02             1.47e+01 </span></span>
<span><span class="co">#&gt;     Corfidi_upwind_A     Corfidi_upwind_M              K_Index </span></span>
<span><span class="co">#&gt;             2.31e+02             9.18e+00             2.44e+01 </span></span>
<span><span class="co">#&gt;      Showalter_Index    TotalTotals_Index          SWEAT_Index </span></span>
<span><span class="co">#&gt;             3.75e+00             4.44e+01             1.06e+02 </span></span>
<span><span class="co">#&gt;              STP_fix              STP_new           STP_fix_LM </span></span>
<span><span class="co">#&gt;             3.60e-01             2.00e-01             1.27e-01 </span></span>
<span><span class="co">#&gt;           STP_new_LM              SCP_fix              SCP_new </span></span>
<span><span class="co">#&gt;             7.08e-02             6.23e+00             4.92e+00 </span></span>
<span><span class="co">#&gt;           SCP_fix_LM           SCP_new_LM                 SHIP </span></span>
<span><span class="co">#&gt;            -5.37e-01            -4.24e-01             6.29e-01 </span></span>
<span><span class="co">#&gt;                  HSI                  DCP         MU_WMAXSHEAR </span></span>
<span><span class="co">#&gt;             1.72e+00             1.15e+00             1.21e+03 </span></span>
<span><span class="co">#&gt;         SB_WMAXSHEAR         ML_WMAXSHEAR     MU_EFF_WMAXSHEAR </span></span>
<span><span class="co">#&gt;             1.21e+03             1.03e+03             9.58e+02 </span></span>
<span><span class="co">#&gt;     SB_EFF_WMAXSHEAR     ML_EFF_WMAXSHEAR             EHI_500m </span></span>
<span><span class="co">#&gt;             9.58e+02             7.97e+02             2.80e-01 </span></span>
<span><span class="co">#&gt;             EHI_01km             EHI_03km          EHI_500m_LM </span></span>
<span><span class="co">#&gt;             5.62e-01             2.16e+00             9.88e-02 </span></span>
<span><span class="co">#&gt;          EHI_01km_LM          EHI_03km_LM              SHERBS3 </span></span>
<span><span class="co">#&gt;             1.99e-01            -1.86e-01             6.48e-01 </span></span>
<span><span class="co">#&gt;               SHERBE           SHERBS3_v2            SHERBE_v2 </span></span>
<span><span class="co">#&gt;             7.01e-01             8.64e-01             9.35e-01 </span></span>
<span><span class="co">#&gt;                  DEI              DEI_eff                  TIP </span></span>
<span><span class="co">#&gt;             1.52e+00             1.19e+00             2.44e+00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-4">Example 4<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<p>Download sounding and draw hodograph:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chanhassen</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_sounding.html">get_sounding</a></span><span class="op">(</span>wmo_id <span class="op">=</span> <span class="fl">72649</span>, yy <span class="op">=</span> <span class="fl">2001</span>, mm <span class="op">=</span> <span class="fl">5</span>, dd <span class="op">=</span> <span class="fl">10</span>, hh <span class="op">=</span> <span class="fl">00</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "http://weather.uwyo.edu/cgi-bin/sounding?TYPE=TEXT%3ALIST&amp;YEAR=2001&amp;MONTH=05&amp;FROM=1000&amp;TO=1000&amp;STNM=72649"</span></span>
<span><span class="co">#&gt; /tmp/RtmpRFM7tN/file1b2e6945aa90</span></span>
<span><span class="fu"><a href="../reference/sounding_hodograph.html">sounding_hodograph</a></span><span class="op">(</span>ws <span class="op">=</span> <span class="va">chanhassen</span><span class="op">$</span><span class="va">ws</span>, wd <span class="op">=</span> <span class="va">chanhassen</span><span class="op">$</span><span class="va">wd</span>, </span>
<span>                   altitude <span class="op">=</span> <span class="va">chanhassen</span><span class="op">$</span><span class="va">altitude</span>,max_speed <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Chanhasses - 10 May 2001, 00:00 UTC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getstarted_files/figure-html/example4-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="example-5">Example 5<a class="anchor" aria-label="anchor" href="#example-5"></a>
</h4>
<p>Use the previously downloaded sounding and draw customized Skew-T
plot (e.g. up to 150 hPa instead of default 100 hPa) with changed line
width:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chanhassen = get_sounding(wmo_id = 72649, yy = 2001, mm = 5, dd = 10, hh = 00)</span></span>
<span><span class="fu"><a href="../reference/skewt_plot.html">skewt_plot</a></span><span class="op">(</span>ptop <span class="op">=</span> <span class="fl">150</span>, close_par <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/skewt_lines.html">skewt_lines</a></span><span class="op">(</span><span class="va">chanhassen</span><span class="op">$</span><span class="va">temp</span>, <span class="va">chanhassen</span><span class="op">$</span><span class="va">pressure</span>, ptop <span class="op">=</span> <span class="fl">150</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/skewt_lines.html">skewt_lines</a></span><span class="op">(</span><span class="va">chanhassen</span><span class="op">$</span><span class="va">dpt</span>, <span class="va">chanhassen</span><span class="op">$</span><span class="va">pressure</span>, ptop <span class="op">=</span> <span class="fl">150</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="getstarted_files/figure-html/example5-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="example-6">Example 6<a class="anchor" aria-label="anchor" href="#example-6"></a>
</h4>
<p>Wind speed vertical profile with wind barbs:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chanhassen = get_sounding(wmo_id = 72649, yy = 2001, mm = 5, dd = 10, hh = 00)</span></span>
<span><span class="va">oldpar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>fig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.75</span>, <span class="fl">0.15</span>, <span class="fl">0.9</span><span class="op">)</span>, new <span class="op">=</span> <span class="cn">TRUE</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in par(fig = c(0.1, 0.75, 0.15, 0.9), new = TRUE, mar = c(1, 1, :</span></span>
<span><span class="co">#&gt; calling par(new=TRUE) with no plot</span></span>
<span><span class="fu"><a href="../reference/sounding_wind.html">sounding_wind</a></span><span class="op">(</span>pressure <span class="op">=</span> <span class="va">chanhassen</span><span class="op">$</span><span class="va">pressure</span>, ws <span class="op">=</span> <span class="va">chanhassen</span><span class="op">$</span><span class="va">ws</span>, yaxs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Wind profile: Chanhassen - 10 May 2001 0000 UTC"</span>, outer <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>fig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.95</span>, <span class="fl">0.15</span>, <span class="fl">0.9</span><span class="op">)</span>, new <span class="op">=</span> <span class="cn">TRUE</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sounding_barbs.html">sounding_barbs</a></span><span class="op">(</span><span class="va">chanhassen</span><span class="op">$</span><span class="va">pressure</span>, <span class="va">chanhassen</span><span class="op">$</span><span class="va">ws</span>, <span class="va">chanhassen</span><span class="op">$</span><span class="va">wd</span>, <span class="va">chanhassen</span><span class="op">$</span><span class="va">altitude</span>, interpolate <span class="op">=</span> <span class="cn">FALSE</span>, barb_cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="getstarted_files/figure-html/example6-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "cin" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "cra" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "csi" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "cxy" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "din" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par(oldpar): graphical parameter "page" cannot be set</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-7---thunder-in-python">Example 7 - thunder in Python<a class="anchor" aria-label="anchor" href="#example-7---thunder-in-python"></a>
</h4>
<p>It is possible to launch <code>thunder</code> under Python via
<code>rpy2</code> library. Below you can find the minimum reproducible
example. Make sure that <code>pandas</code> and <code>rpy2</code>
libraries are available for your Python environment. If not install
required python packages with <code>pip install pandas</code> and
<code>pip install rpy2</code></p>
<p>Launch <code>thunder</code> under Python with <code>rpy2</code> and
<code>numpy</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### load required packages</span></span>
<span><span class="co">#&gt; from rpy2.robjects.packages import importr</span></span>
<span><span class="co">#&gt; from rpy2.robjects import r,pandas2ri</span></span>
<span><span class="co">#&gt; import rpy2.robjects as robjects</span></span>
<span><span class="co">#&gt; pandas2ri.activate()</span></span>
<span></span>
<span><span class="co">### load thunder package (make sure that it was installed in R before)</span></span>
<span><span class="co">#&gt; importr('thunder')</span></span>
<span></span>
<span><span class="co">### download North Platte sounding </span></span>
<span><span class="co">#&gt; profile = robjects.r['get_sounding'](wmo_id = 72562, yy = 1999, mm = 7, dd = 3,hh = 0)</span></span>
<span></span>
<span><span class="co">### compute convective parameters</span></span>
<span><span class="co">#&gt; parameters = robjects.r['sounding_compute'](profile['pressure'], profile['altitude'], #&gt; profile['temp'], profile['dpt'], profile['wd'], profile['ws'], accuracy = 2)</span></span>
<span></span>
<span></span>
<span><span class="co">### customize output and print all computed variables, e.g. most-unstable CAPE (first element) equals 9413 J/kg</span></span>
<span></span>
<span><span class="co">#&gt; print(list(map('{:.2f}'.format, parameters)))</span></span>
<span><span class="co"># '9413.29', '233.35', '1713.74', '0.00', '775.00', '775.00', '15500.00', '-16.55', </span></span>
<span><span class="co"># '137.21', '-66.63', '23.98', '23.98', '23.36', '9413.29', '233.35', '1713.74', '0.00', </span></span>
<span><span class="co"># '775.00', '775.00', '15500.00', '-16.55', '137.21', '-66.63', '23.98', '23.98', '23.36',</span></span>
<span><span class="co"># '7805.13', '115.22', '1515.81', '-4.35', '950.00', '950.00', '15000.00', '-14.66', </span></span>
<span><span class="co"># '124.94', '-68.41', '22.46', '22.46', '21.17', '-9.57', '-6.68', '-8.80', '-8.68', </span></span>
<span><span class="co"># '-9.06', '-7.70', '4250.00', '3500.00', '0.00', '2866.00', '50.57', '52.93', '1381.81', </span></span>
<span><span class="co"># '308.98', '29.00', '37.59', '87.03', '0.58', '0.40', '0.47', '8.85', '11.21', '13.88', </span></span>
<span><span class="co"># '20.28', '29.33', '6.84', '21.70', '28.32', '28.32', '27.17', '17.06', '12.53', '12.53',</span></span>
<span><span class="co"># '11.74', '7.09', '6.08', '7.77', '7.69', '19.89', '62.07', '110.06', '156.48', '6.25', </span></span>
<span><span class="co"># '7.77', '4.26', '-42.78', '284.67', '5.65', '197.60', '14.19', '218.89', '7.77',</span></span>
<span><span class="co"># '31.50', '-12.14', '60.40', '677.12', '4.67', '6.10', '29.46', '29.46', '3.86', '12.35',</span></span>
<span><span class="co"># '2783.07', '2783.07', '2534.22', '3886.07', '3886.07', '3395.00']</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="important-notes">Important notes<a class="anchor" aria-label="anchor" href="#important-notes"></a>
</h4>
<ul>
<li>Remember to always input wind speed data in knots.</li>
<li>Script will always consider first height level as the surface (h =
0), therefore input height data can be as above sea level (ASL) or above
ground level (AGL).</li>
<li>For efficiency purposes it is highly recommended to input data for a
maximum of 16-18 km AGL or lower.</li>
<li>Values of parameters will be different for different accuracy
settings.</li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bartosz Czernecki, Mateusz Taszarek, Piotr Szuster.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
